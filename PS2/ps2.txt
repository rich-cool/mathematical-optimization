%------------------Steepest Descent------------------%
function []=SteepestDescent(a, b)

ff=@(x,y) 100*(y-x^2)^2+(1-x)^2;
gf=@(x,y) [-400*x*(y-x^2)-2*(1-x);200*(y-x^2)]; 
Hf=@(x,y) [800*y^2-400*(y-x^2)+2 -400*x;-400*x 200];

x0=[a;b];
w=0.8;
c=0.1;
for j=1:10
    pk=-gf(x0(1),x0(2));
    alpha=1;
    while x0(2)+alpha*pk(2)<=0
        alpha=alpha*w;
    end
    nf=ff(x0(1)+alpha*pk(1),x0(2)+alpha*pk(2));
    dd=gf(x0(1),x0(2))'*pk;
    while (nf>ff(x0(1),x0(2))+c*dd*alpha)
        alpha=alpha*w;
        nf=ff(x0(1)+alpha*pk(1),x0(2)+alpha*pk(2));
    end
    alpha
    x1=x0+alpha*pk
    x0=x1;
    pause
end
%----------------------------------------------------%

SteepestDescent(1.2, 1.2)

alpha =

    0.0012


x1 =

    1.0569
    1.2594


alpha =

    0.0015


x1 =

    1.1499
    1.2154


alpha =

    0.0012


x1 =

    1.0887
    1.2418


alpha =

    0.0012


x1 =

    1.1190
    1.2278


alpha =

    0.0012


x1 =

    1.1052
    1.2338


alpha =

    0.0012


x1 =

    1.1117
    1.2308


alpha =

    0.0012


x1 =

    1.1086
    1.2320


alpha =

    0.0012


x1 =

    1.1100
    1.2313


alpha =

    0.0015


x1 =

    1.1091
    1.2315


alpha =

    0.0015


x1 =

    1.1097
    1.2311

SteepestDescent(-1.2, 1)

alpha =

    0.0012


x1 =

   -0.9331
    1.1089


alpha =

    0.0015


x1 =

   -1.0647
    1.0352


alpha =

    0.0015


x1 =

   -0.9935
    1.0657


alpha =

    0.0015


x1 =

   -1.0357
    1.0413


alpha =

    0.0015


x1 =

   -1.0093
    1.0510


alpha =

    0.0015


x1 =

   -1.0233
    1.0410


alpha =

    0.0015


x1 =

   -1.0132
    1.0429


alpha =

    0.0019


x1 =

   -1.0182
    1.0365


alpha =

    0.5120


x1 =

    1.0984
    1.0611


alpha =

    0.0015


x1 =

    0.9992
    1.1061

%------------------Newton Method------------------%
function []=NewtonMethod(a, b)

ff=@(x,y) 100*(y-x^2)^2+(1-x)^2;
gf=@(x,y) [-400*x*(y-x^2)-2*(1-x);200*(y-x^2)]; 
Hf=@(x,y) [800*y^2-400*(y-x^2)+2 -400*x;-400*x 200];

x0=[a;b];
w=0.8;
c=0.1;
for j=1:17
    pk=-(inv(Hf(x0(1),x0(2)))*gf(x0(1),x0(2)));
    alpha=1;
    while x0(2)+alpha*pk(2)<=0
        alpha=alpha*w;
    end
    nf=ff(x0(1)+alpha*pk(1),x0(2)+alpha*pk(2));
    dd=gf(x0(1),x0(2))'*pk;
    while (nf>ff(x0(1),x0(2))+c*dd*alpha)
        alpha=alpha*w;
        nf=ff(x0(1)+alpha*pk(1),x0(2)+alpha*pk(2));
    end
    Hf(x0(1),x0(2))
    alpha
    x1=x0+alpha*pk
    x0=x1;
    pause
end
%---------------------------------------------------%	
	
NewtonMethod(1.2,1.2)

ans =

        1250        -480
        -480         200


alpha =

     1


x1 =

    1.1959
    1.4302


ans =

   1.0e+03 *

    1.6384   -0.4784
   -0.4784    0.2000


alpha =

     1


x1 =

    1.1951
    1.4283


ans =

   1.0e+03 *

    1.6341   -0.4781
   -0.4781    0.2000


alpha =

     1


x1 =

    1.1943
    1.4264


ans =

   1.0e+03 *

    1.6298   -0.4777
   -0.4777    0.2000


alpha =

     1


x1 =

    1.1935
    1.4245


ans =

   1.0e+03 *

    1.6254   -0.4774
   -0.4774    0.2000


alpha =

     1


x1 =

    1.1927
    1.4226


ans =

   1.0e+03 *

    1.6211   -0.4771
   -0.4771    0.2000


alpha =

     1


x1 =

    1.1919
    1.4207


ans =

   1.0e+03 *

    1.6168   -0.4768
   -0.4768    0.2000


alpha =

     1


x1 =

    1.1911
    1.4188


ans =

   1.0e+03 *

    1.6124   -0.4765
   -0.4765    0.2000


alpha =

     1


x1 =

    1.1903
    1.4169


ans =

   1.0e+03 *

    1.6081   -0.4761
   -0.4761    0.2000


alpha =

     1


x1 =

    1.1895
    1.4150


ans =

   1.0e+03 *

    1.6038   -0.4758
   -0.4758    0.2000


alpha =

     1


x1 =

    1.1887
    1.4131


ans =

   1.0e+03 *

    1.5995   -0.4755
   -0.4755    0.2000


alpha =

     1


x1 =

    1.1879
    1.4112


ans =

   1.0e+03 *

    1.5951   -0.4752
   -0.4752    0.2000


alpha =

     1


x1 =

    1.1871
    1.4093


ans =

   1.0e+03 *

    1.5908   -0.4748
   -0.4748    0.2000


alpha =

     1


x1 =

    1.1863
    1.4073


ans =

   1.0e+03 *

    1.5865   -0.4745
   -0.4745    0.2000


alpha =

     1


x1 =

    1.1855
    1.4054


ans =

   1.0e+03 *

    1.5822   -0.4742
   -0.4742    0.2000


alpha =

     1


x1 =

    1.1847
    1.4035


ans =

   1.0e+03 *

    1.5779   -0.4739
   -0.4739    0.2000


alpha =

     1


x1 =

    1.1839
    1.4016


ans =

   1.0e+03 *

    1.5736   -0.4736
   -0.4736    0.2000


alpha =

     1


x1 =

    1.1831
    1.3997

NewtonMethod(-1.2,1)

ans =

   978   480
   480   200


alpha =

     1


x1 =

   -1.2253
    1.5007


ans =

   1.0e+03 *

    1.8039    0.4901
    0.4901    0.2000


alpha =

     1


x1 =

   -1.2179
    1.4832


ans =

   1.0e+03 *

    1.7620    0.4872
    0.4872    0.2000


alpha =

     1


x1 =

   -1.2102
    1.4645


ans =

   1.0e+03 *

    1.7179    0.4841
    0.4841    0.2000


alpha =

     1


x1 =

   -1.2021
    1.4450


ans =

   1.0e+03 *

    1.6724    0.4808
    0.4808    0.2000


alpha =

     1


x1 =

   -1.1936
    1.4245


ans =

   1.0e+03 *

    1.6255    0.4774
    0.4774    0.2000


alpha =

     1


x1 =

   -1.1845
    1.4031


ans =

   1.0e+03 *

    1.5769    0.4738
    0.4738    0.2000


alpha =

     1


x1 =

   -1.1749
    1.3804


ans =

   1.0e+03 *

    1.5264    0.4700
    0.4700    0.2000


alpha =

     1


x1 =

   -1.1646
    1.3562


ans =

   1.0e+03 *

    1.4735    0.4658
    0.4658    0.2000


alpha =

     1


x1 =

   -1.1535
    1.3304


ans =

   1.0e+03 *

    1.4180    0.4614
    0.4614    0.2000


alpha =

     1


x1 =

   -1.1413
    1.3024


ans =

   1.0e+03 *

    1.3591    0.4565
    0.4565    0.2000


alpha =

     1


x1 =

   -1.1278
    1.2717


ans =

   1.0e+03 *

    1.2959    0.4511
    0.4511    0.2000


alpha =

     1


x1 =

   -1.1125
    1.2374


ans =

   1.0e+03 *

    1.2271    0.4450
    0.4450    0.2000


alpha =

     1


x1 =

   -1.0947
    1.1980


ans =

   1.0e+03 *

    1.1502    0.4379
    0.4379    0.2000


alpha =

     1


x1 =

   -1.0728
    1.1504


ans =

   1.0e+03 *

    1.0610    0.4291
    0.4291    0.2000


alpha =

     1


x1 =

   -1.0432
    1.0875


ans =

  948.4378  417.2966
  417.2966  200.0000


alpha =

     1


x1 =

   -0.9907
    0.9787


ans =

  769.3826  396.2744
  396.2744  200.0000


alpha =

   1.9979e-16


x1 =

   -0.9907
    0.9787

%------------------Cholesky Factorization------------------%
function []=Cholesky(aa)

n = 5;
A = aa;
L = eye(n);
D = eye(n);

for j=1:n
    sum1 = 0;
    for s=1:j-1
        sum1 = sum1+(D(s,s)*L(j,s)^2);
    end
    D(j,j) = A(j,j) - sum1;
    for i = j+1:n
        sum2 = 0;
        for k=1:j-1
            sum2 = sum2+(D(k,k)*L(i,k)*L(j,k));
        end
        L(i,j) = (A(i,j)-sum2)/D(j,j);
    end
end

L
D
L'
A
L*D*L'
%-----------------------------------------------------------%	
	
A = [1 2 1 1 1;2 5 1 3 1;1 1 6 0 6;1 3 0 3 0;1 1 6 0 7];

Cholesky(A)

L =

     1     0     0     0     0
     2     1     0     0     0
     1    -1     1     0     0
     1     1     0     1     0
     1    -1     1     0     1


D =

     1     0     0     0     0
     0     1     0     0     0
     0     0     4     0     0
     0     0     0     1     0
     0     0     0     0     1


ans(L') =

     1     2     1     1     1
     0     1    -1     1    -1
     0     0     1     0     1
     0     0     0     1     0
     0     0     0     0     1


A =

     1     2     1     1     1
     2     5     1     3     1
     1     1     6     0     6
     1     3     0     3     0
     1     1     6     0     7


ans(L*D*L') =

     1     2     1     1     1
     2     5     1     3     1
     1     1     6     0     6
     1     3     0     3     0
     1     1     6     0     7

%------------------------BFGS------------------------%
function []=BFGS(a, b)

ff=@(x,y) 100*(y-x^2)^2+(1-x)^2;
gf=@(x,y) [-400*x*(y-x^2)-2*(1-x);200*(y-x^2)]; 
Hf=@(x,y) [800*y^2-400*(y-x^2)+2 -400*x;-400*x 200];

x0=[a;b];
w=0.8;
c=0.1;
Bk=inv(Hf(x0(1),x0(2)));
determinant = det(Bk)
for j=1:15
    pk=-(Bk*gf(x0(1),x0(2)));
    alpha=1;
    while x0(2)+alpha*pk(2)<=0
        alpha=alpha*w;
    end
    nf=ff(x0(1)+alpha*pk(1),x0(2)+alpha*pk(2));
    dd=gf(x0(1),x0(2))'*pk;
    while (nf>ff(x0(1),x0(2))+c*dd*alpha)
        alpha=alpha*w;
        nf=ff(x0(1)+alpha*pk(1),x0(2)+alpha*pk(2));
    end
    alpha
    sk=alpha*pk;
    x1=x0+sk;
    yk=gf(x1(1),x1(2))-gf(x0(1),x0(2));
    Bk= Bk-(Bk*(sk*sk')*Bk')/(sk'*Bk*sk)+(yk*yk')/(yk'*sk);
    x0=x1
    yk'*sk
    pause
end
%-----------------------------------------------------%	 
	 
BFGS(1.2,1.2)

determinant (initial) =

   5.1020e-05


alpha =

     1


x0 =

    1.1959
    1.4302


ans =

   11.5192


alpha =

   9.8080e-07


x0 =

    1.1955
    1.4304


ans =

   3.2445e-04


alpha =

   9.8080e-07


x0 =

    1.1958
    1.4302


ans =

   1.9753e-04


alpha =

   9.8080e-07


x0 =

    1.1955
    1.4304


ans =

   1.1853e-04


alpha =

   9.8080e-07


x0 =

    1.1958
    1.4303


ans =

   7.1139e-05


alpha =

   9.8080e-07


x0 =

    1.1956
    1.4303


ans =

   4.2691e-05


alpha =

   9.8080e-07


x0 =

    1.1957
    1.4303


ans =

   2.5621e-05


alpha =

   9.8080e-07


x0 =

    1.1956
    1.4303


ans =

   1.5376e-05


alpha =

   9.8080e-07


x0 =

    1.1957
    1.4303


ans =

   9.2276e-06


alpha =

   9.8080e-07


x0 =

    1.1956
    1.4303


ans =

   5.5377e-06


alpha =

   9.8080e-07


x0 =

    1.1957
    1.4303


ans =

   3.3234e-06


alpha =

   9.8080e-07


x0 =

    1.1956
    1.4303


ans =

   1.9945e-06


alpha =

   9.8080e-07


x0 =

    1.1957
    1.4303


ans =

   1.1969e-06


alpha =

   9.8080e-07


x0 =

    1.1957
    1.4303


ans =

   7.1832e-07


alpha =

   9.8080e-07


x0 =

    1.1957
    1.4303


ans =

   4.3109e-07

BFGS(-1.2,1)

determinant (initial) =

  -2.8736e-05


alpha =

     1


x0 =

   -1.2253
    1.5007


ans =

   38.6652


alpha =

   5.0706e-04


x0 =

    1.5829
    2.6711


ans =

 -238.5981


alpha =

   2.1246e-20


x0 =

    1.5829
    2.6711


ans =

     0


alpha =

     1


x0 =

   NaN
   NaN


ans =

   NaN